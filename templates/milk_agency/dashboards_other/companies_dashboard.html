{% extends "milk_agency/home/base.html" %}

{% block title %}Companies Dashboard{% endblock %}

{% block content %}

<div class="container-fluid py-5">

    <!-- Page Header -->
    <div class="d-flex justify-content-between align-items-center mb-5 flex-wrap">
        <h2 class="fw-bold mb-3 mb-md-0">Companies</h2>
        <a href="{% url 'milk_agency:add_company' %}" 
           class="btn btn-info fw-bold d-flex align-items-center">
            <i class="bi bi-plus-circle me-2"></i>Add Company
        </a>
    </div>

    {% if companies %}
    <!-- FULL-WIDTH GRID -->
    <div class="companies-grid">
        {% for company in companies %}
        <div class="company-card shadow-lg rounded-4 position-relative overflow-hidden">
            <!-- Banner -->
            <div class="banner"></div>
            <!-- Logo -->
            <div class="logo-wrapper">
                {% if company.logo %}
                <img src="{{ company.logo.url }}" 
                     class="company-logo shadow-lg" 
                     alt="{{ company.name }}">
                {% else %}
                <div class="company-logo placeholder-logo shadow-lg">
                    {{ company.name|first|upper }}
                </div>
                {% endif %}
            </div>
            <!-- Text Section -->
            <div class="p-4 text-center mt-4">
                <h3 class="fw-bold mb-1">{{ company.name }}</h3>

                {% if company.website_link %}
                <a href="{{ company.website_link }}" 
                   class="text-primary small text-decoration-none" 
                   target="_blank">
                    Visit Website →
                </a>
                {% else %}
                <p class="text-muted small mb-0">No website available</p>
                {% endif %}
            </div>
            <!-- Buttons -->
            <div class="btn-section">
                <a href="{% url 'milk_agency:items_dashboard' %}?company={{ company.name|urlencode }}"
                   class="btn btn-outline-primary flex-grow-1 rounded-pill d-flex align-items-center justify-content-center gap-2">
                   <i class="bi bi-box"></i> Items
                </a>

                <a href="{% url 'milk_agency:edit_company' company.id %}"
                   class="btn btn-primary flex-grow-1 rounded-pill d-flex align-items-center justify-content-center gap-2">
                   <i class="bi bi-pencil-square"></i> Edit
                </a>
            </div>
        </div>
        {% endfor %}
    </div>

    {% else %}
    <!-- Empty State -->
    <div class="text-center py-5">
        <i class="bi bi-building fs-1 text-muted"></i>
        <h4 class="mt-3">No companies found</h4>
        <p class="text-muted">Add companies to get started.</p>
        <a href="{% url 'milk_agency:add_company' %}" class="btn btn-outline-primary px-4 rounded-pill">
            <i class="bi bi-plus-circle"></i> Add Company
        </a>
    </div>
    {% endif %}

</div>

<style>
/* GRID */
.companies-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
    gap: 3rem;
    width: 100%;
    padding: 0 20px;
    justify-items: center;
}

/* PREMIUM CARD */
.company-card {
    background: rgba(255,255,255,0.9);
    border-radius: 32px;
    overflow: hidden;
    border: 1px solid rgba(255,255,255,0.4);
    backdrop-filter: blur(12px);
    box-shadow: 0 15px 40px rgba(0,0,0,0.15);
    transition: all 0.35s ease;
    max-width: 520px;
    width: 100%;
}

.company-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 20px 50px rgba(0,0,0,0.25);
    border-color: rgba(0,0,0,0.15);
}

/* GRADIENT BANNER */
.banner {
    height: 160px;
    width: 100%;
    background: linear-gradient(135deg, #6a11cb, #2575fc, #00d4ff);
    background-size: 200% 200%;
    animation: bannerGradient 6s ease infinite;
}

@keyframes bannerGradient {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* EXTRA BIG LOGO – Hero Style (200px) */
.logo-wrapper {
    position: absolute;
    top: 60px;  /* Perfect half over banner and half over white */
    left: 50%;
    transform: translateX(-50%);
    width: 200px;
    height: 200px;
    border-radius: 40px;
    background: #ffffff;
    box-shadow: 0 25px 60px rgba(0,0,0,0.28);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    z-index: 5;
}

.company-logo {
    width: 100%;
    height: 100%;
    border-radius: 36px;
    padding: 16px;
    object-fit: contain;
}


.logo-wrapper:hover {
    transform: translateX(-50%) scale(1.05);
    box-shadow: 0 20px 45px rgba(0,0,0,0.35);
}

/* TEXT AREA */
.company-card h3 {
    font-size: 1.8rem;
    font-weight: 700;
    margin-top: 90px;
    color: #0d0d0d;
}

.company-card a {
    font-weight: 500;
}

/* BUTTON AREA */
.btn-section {
    padding: 1rem 2rem;
    display: flex;
    gap: 1rem;
    background: #f7f7f7;
    border-top: 1px solid #e0e0e0;
    border-bottom-left-radius: 32px;
    border-bottom-right-radius: 32px;
}

/* BUTTONS */
.btn-section .btn {
    flex: 1;
    border-radius: 50px;
    font-weight: 600;
    padding: 10px 0;
    transition: all 0.25s ease;
}

/* Hover effect for buttons */
.btn-section .btn:hover {
    transform: translateY(-3px);
}
</style>

{% endblock %}
