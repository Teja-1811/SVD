{% extends "milk_agency/home/base.html" %}
{% load static %}

{% block title %}Companies Dashboard{% endblock %}

{% block content %}
<div class="container-fluid companies-page">

    <!-- PAGE HEADER -->
    <div class="page-header d-flex align-items-center justify-content-start flex-wrap gap-3">
        <div>
            <h1 class="page-title">Companies</h1>
            <p class="page-sub">Manage company catalogs, stock & values</p>
        </div>

        <a href="{% url 'milk_agency:add_company' %}" class="btn add-company d-inline-flex align-items-center gap-2 ms-auto">
            <i class="bi bi-plus-circle"></i>
            Add Company
        </a>
    </div>

    {% if companies %}
    <!-- GRID -->
    <div class="companies-grid">
        {% for company in companies %}
        <article class="company-card">

            <!-- BANNER -->
            <div class="card-banner"></div>

            <!-- LOGO -->
            <div class="logo-area">
                {% if company.logo %}
                <img src="{{ company.logo.url }}" alt="{{ company.name }}" class="company-logo">
                {% else %}
                <img src="/mnt/data/faeeaa76-4cf5-4695-9092-f252e463d81a.png"
                     class="company-logo" alt="{{ company.name }}">
                {% endif %}
            </div>

            <!-- BODY -->
            <div class="card-body">
                <h2 class="company-name">{{ company.name }}</h2>

                {% if company.website_link %}
                <a href="{{ company.website_link }}" class="company-website" target="_blank">Visit Website →</a>
                {% else %}
                <p class="no-website">No website available</p>
                {% endif %}

                <div class="stats">
                    <div class="stat-row">
                        <span class="label">Items:</span>
                        <span class="value">{{ company.total_items }}</span>
                    </div>
                    <div class="stat-row">
                        <span class="label">Total Stock:</span>
                        <span class="value">{{ company.total_qty }}</span>
                    </div>
                    <div class="stat-row">
                        <span class="label">Stock Value:</span>
                        <span class="value value-money">₹{{ company.total_value|floatformat:2 }}</span>
                    </div>
                </div>
            </div>

            <!-- FOOTER BUTTONS -->
            <div class="card-footer">
                <a href="{% url 'milk_agency:items_dashboard' %}?company={{ company.id }}"
                   class="btn-outline action-btn items-btn">
                    <i class="bi bi-box"></i>
                    <span>Items</span>
                </a>

                <a href="{% url 'milk_agency:edit_company' company.id %}"
                   class="btn-primary action-btn edit-btn">
                    <i class="bi bi-pencil-square"></i>
                    <span>Edit</span>
                </a>
            </div>

        </article>
        {% endfor %}
    </div>

    {% else %}
    <!-- EMPTY STATE -->
    <div class="empty-state">
        <i class="bi bi-building large-ghost"></i>
        <h3>No companies found</h3>
        <p class="muted">Add companies to get started.</p>
        <a href="{% url 'milk_agency:add_company' %}" class="btn outline-large">
            <i class="bi bi-plus-circle"></i> Add Company
        </a>
    </div>
    {% endif %}

</div>

<!-- FULL CSS -->
<style>
:root {
    --bg: #f5f8fb;
    --card-bg: rgba(255,255,255,0.85);
    --glass-border: rgba(255,255,255,0.55);
    --muted: #7b8596;
    --accent1: #6a11cb;
    --accent2: #2575fc;
    --accent3: #00d4ff;
    --success: #1fa45a;
    --radius: 24px;
}

/* MAIN PAGE */
.companies-page {
    padding: 20px;
    background: linear-gradient(180deg, var(--bg), #fff 60%);
}

/* HEADER */
.page-header {
    margin-bottom: 25px;
}
.page-title {
    margin: 0;
    font-size: 1.35rem;
    font-weight: 800;
    color: #0b1220;
}
.page-sub {
    margin: 2px 0 0;
    color: var(--muted);
    font-size: .92rem;
}

/* ADD COMPANY BUTTON */
.add-company {
    background: linear-gradient(90deg,var(--accent2),var(--accent3));
    color: #fff;
    padding: 8.5px 15px;
    border-radius: 999px;
    font-weight: 700;
    border: none;
}

/* GRID */
.companies-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 22px;
    justify-content: center;
}

/* CARD */
.company-card {
    background: var(--card-bg);
    border-radius: var(--radius);
    border: 1px solid var(--glass-border);
    backdrop-filter: blur(14px);
    overflow: visible;
    box-shadow: 0 10px 35px rgba(0,0,0,0.08);
    transition: .3s ease;
}
.company-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 18px 55px rgba(0,0,0,0.12);
}

/* BANNER */
.card-banner {
    height: 130px;
    background: linear-gradient(135deg,var(--accent1),var(--accent2),var(--accent3));
    background-size: 200% 200%;
    animation: bannerShift 7s ease infinite;
    border-radius: var(--radius) var(--radius) 0 0;
}
@keyframes bannerShift {
    0% {background-position: 0% 50%;}
    50% {background-position: 100% 50%;}
    100% {background-position: 0% 50%;}
}

/* LOGO */
.logo-area {
    position: absolute;
    top: 62px;
    left: 50%;
    transform: translateX(-50%);
    width: 190px;
    height: 190px;
    background: #fff;
    border-radius: 34px;
    box-shadow: 0 25px 55px rgba(0,0,0,0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 15px;
}
.company-logo {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border-radius: 26px;
}

/* BODY */
.card-body {
    padding: 130px 20px 20px;
    text-align: center;
}
.company-name {
    font-size: 1.35rem;
    font-weight: 800;
    margin: 0;
}
.company-website {
    display: inline-block;
    margin-top: 5px;
    color: var(--accent2);
    text-decoration: none;
    font-weight: 600;
}
.no-website {
    margin-top: 5px;
    color: var(--muted);
}

/* STATS */
.stats {
    margin-top: 12px;
    padding: 13px;
    background: rgba(255,255,255,0.75);
    border-radius: 14px;
    border: 1px solid rgba(0,0,0,0.04);
}
.stat-row {
    display: flex;
    justify-content: space-between;
    padding: 6px 0;
}
.label {
    color: var(--muted);
}
.value-money {
    color: var(--success);
    font-weight: 700;
}

/* FOOTER BUTTONS */
.card-footer {
    display: flex;
    gap: 10px;
    padding: 16px;
    border-top: 1px solid rgba(0,0,0,0.05);
    background: rgba(255,255,255,0.55);
    border-radius: 0 0 var(--radius) var(--radius);
}
.action-btn {
    flex: 1;
    padding: 10px;
    border-radius: 999px;
    text-decoration: none;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    font-weight: 700;
}

/* BUTTON TYPES */
.items-btn {
    border: 1.5px solid rgba(37,117,252,0.18);
    color: var(--accent2);
}
.edit-btn {
    background: linear-gradient(90deg,var(--accent2),var(--accent3));
    color: #fff;
    box-shadow: 0 8px 22px rgba(37,117,252,0.18);
}

/* EMPTY */
.empty-state {
    padding: 60px 20px;
    text-align: center;
}

/* RESPONSIVE LAYOUTS */
@media (min-width: 720px) {
    .companies-grid {
        grid-template-columns: repeat(2, 350px);
    }
}
@media (min-width: 1024px) {
    .companies-grid {
        grid-template-columns: repeat(3, 350px);
        gap: 26px;
        justify-content: center;
    }
}
@media (min-width: 1440px) {
    .companies-grid {
        grid-template-columns: repeat(4, 350px);
    }
}
@media (max-width: 480px) {
    .card-footer {
        flex-direction: column;
    }
}
</style>

{% endblock %}
